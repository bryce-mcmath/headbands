(this.webpackJsonpheadbandz=this.webpackJsonpheadbandz||[]).push([[0],{37:function(e,t,n){e.exports=n(80)},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},46:function(e,t,n){},76:function(e,t){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(33),c=n.n(o),i=(n(42),n(35)),u=n(36),s=n(2);n(43),n(44);var l=function(e){var t=e.stream,n=e.id;return Object(a.useEffect)((function(){document.getElementById(n).srcObject=t}),[t]),r.a.createElement("div",{className:"video-container"},r.a.createElement("video",{id:n,autoPlay:!0,playsInline:!0}))},m=n(1),d=n.n(m),f=n(3);n(46);var p="iceCandidate",b="joinRequest",v="offer",E="answer",h="cannot join",w="gameReady",g="give names",j="name taken",O="room name ok",y="joining",k={};function I(e,t,n){var a,r;k[e]=new RTCPeerConnection(null),r=e,(a=t).getTracks().forEach((function(e){k[r].addTrack(e,a)})),k[e].ontrack=function(t){return n(t.streams[0],e)}}function x(){return(x=Object(f.a)(d.a.mark((function e(t,n,a,r,o,c,i,u){var s,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),e.t0=t.type,e.next=e.t0===p?4:e.t0===b?5:e.t0===v?12:e.t0===E?22:e.t0===h?27:e.t0===g?28:e.t0===j?29:e.t0===O?30:e.t0===w?31:e.t0===y?32:34;break;case 4:return e.abrupt("return",k[t.fromId].addIceCandidate(new RTCIceCandidate(t.candidate)));case 5:return I(t.fromId,n,r),e.next=8,k[t.fromId].createOffer();case 8:return s=e.sent,e.next=11,k[t.fromId].setLocalDescription(s);case 11:return e.abrupt("return",a.emit("description",{description:k[t.fromId].localDescription,toId:t.fromId,fromId:a.id}));case 12:return I(t.fromId,n,r),k[t.fromId].onicecandidate=function(e){e.candidate&&a.emit("iceCandidate",{candidate:e.candidate,fromId:t.toId,toId:t.fromId})},e.next=16,k[t.fromId].setRemoteDescription(t.description);case 16:return e.next=18,k[t.fromId].createAnswer();case 18:return l=e.sent,e.next=21,k[t.fromId].setLocalDescription(l);case 21:return e.abrupt("return",a.emit("answer",{answer:l,toId:t.fromId,fromId:a.id}));case 22:return console.log(window.roomName),a.emit("ready",window.roomName),e.next=26,k[t.fromId].setRemoteDescription(t.answer);case 26:return e.abrupt("return",e.sent);case 27:return e.abrupt("return",console.log("handle room name here"));case 28:return e.abrupt("return",c(t.names));case 29:return e.abrupt("return",console.log("name taken"));case 30:return e.abrupt("return",window.dispatchEvent(new Event("makeRoom")));case 31:return e.abrupt("return",window.dispatchEvent(new Event("gameReady")));case 32:return u.current=t.players,e.abrupt("return",i(!0));case 34:console.log("no handling for server socket emit: ");case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=n(34),C=n.n(N);n(79);function S(e,t,n){return R.apply(this,arguments)}function R(){return(R=Object(f.a)(d.a.mark((function e(t,n,a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 2:r=e.sent,t(r,"local");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P,D=function(e){var t=e.addStreams,n=e.socket,o=(e.setNumPlayers,e.setRoom),c=e.setGameOn,i=e.numPlayers,u=Object(a.useState)(!1),l=Object(s.a)(u,2),m=l[0],p=l[1],b=Object(a.useState)(!1),v=Object(s.a)(b,2),E=v[0],h=v[1],w=Object(a.useState)(!1),g=Object(s.a)(w,2),j=(g[0],g[1]),O=Object(a.useState)(""),y=Object(s.a)(O,2),k=y[0],I=y[1],x=Object(a.useState)(""),N=Object(s.a)(x,2),C=N[0],R=N[1],P=Object(a.useState)(""),D=Object(s.a)(P,2);function G(){return(G=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return",console.log("Need to add players"));case 2:n.emit("make room",{name:C,totalPlayers:Number(i.current)});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:o(k),window.roomName=k,n.emit("join room",{roomName:k,fromId:n.id});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return D[0],D[1],Object(a.useEffect)((function(){window.addEventListener("gameReady",(function(){return j(!0)})),window.addEventListener("makeRoom",Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t,"local");case 2:console.log("setting room"),o(window.roomName),c(!0);case 5:case"end":return e.stop()}}),e)}))))}),[]),r.a.createElement("div",{className:"container"},r.a.createElement("div",null,r.a.createElement("button",{className:"landing-button",onClick:function(){p((function(e){return!e}))}},"Create Game"),r.a.createElement("div",{className:"input-slider",style:{height:m?"80px":"0px"}},r.a.createElement("div",{className:"player-number"},r.a.createElement("label",{htmlFor:"players-number"},"Total Players: "),r.a.createElement("select",{id:"players-number",onChange:function(e){return i.current=Number(e.target.value)}},r.a.createElement("option",null,"2"),r.a.createElement("option",null,"3"),r.a.createElement("option",null,"4"),r.a.createElement("option",null,"5"),r.a.createElement("option",null,"6"),r.a.createElement("option",null,"7"))),r.a.createElement("div",{className:"game-name"},r.a.createElement("input",{type:"text",onChange:function(e){R(e.target.value),window.roomName=e.target.value},placeholder:"Enter game name"}),r.a.createElement("button",{onClick:function(){return G.apply(this,arguments)}},"Go!")))),r.a.createElement("div",null,r.a.createElement("button",{className:"landing-button",onClick:function(){h((function(e){return!e}))}},"Join Game"),r.a.createElement("div",{className:"input-slider",style:{height:E?"80px":"0px"}},r.a.createElement("div",{className:"game-name"},r.a.createElement("input",{type:"text",onChange:function(e){I(e.target.value),window.roomName=e.target.value}}),r.a.createElement("button",{onClick:function(){return T.apply(this,arguments)}},"Go!")))))};var G=function(){var e=Object(a.useState)(),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)([]),m=Object(s.a)(c,2),d=m[0],f=m[1],p=Object(a.useState)([]),b=Object(s.a)(p,2),v=b[0],E=b[1],h=Object(a.useState)(""),w=Object(s.a)(h,2),g=w[0],j=w[1],O=Object(a.useState)(!1),y=Object(s.a)(O,2),k=y[0],I=y[1],N=Object(a.useRef)(2);function S(e){f((function(t){var n=[];return t.forEach((function(t){var a=e.find((function(e){return e.toId===t.socketId}));n.push(Object(u.a)({},t,{name:a&&a.name}))})),n}))}function R(e,t){var n;f((function(a){return 0===a.length&&(P=e),n=a.length+1,[].concat(Object(i.a)(a),[{stream:e,socketId:t}])})),E((function(e){return new Array(N.current-n).fill(0)}))}return Object(a.useEffect)((function(){var e=C.a.connect("http://192.168.0.100:3001");e.on("message",(function(t){!function(e,t,n,a,r,o,c,i){x.apply(this,arguments)}(t,P,e,R,g,S,I,N)})),o(e)}),[]),r.a.createElement("div",{className:"App"},r.a.createElement("main",null,r.a.createElement("h1",null,"Headbandz"),!k&&r.a.createElement(D,{addStreams:R,socket:n,setRoom:j,setGameOn:I,numPlayers:N}),k&&r.a.createElement("div",null,r.a.createElement("div",{className:"videos-container"},r.a.createElement("h2",null,"In room: ",g),r.a.createElement(l,{id:"local",stream:d[0]&&d[0].stream}),d.slice(1).map((function(e,t){return r.a.createElement("div",null,r.a.createElement(l,{stream:e.stream,key:t,id:"stream".concat(t)}),r.a.createElement("h3",null,e.name))})),v.map((function(){return r.a.createElement("div",{className:"video-container"})})))),r.a.createElement("button",{onClick:function(){console.log(d)}},"log streams")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.f0365d9e.chunk.js.map